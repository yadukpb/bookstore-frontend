{"ast":null,"code":"const {\n  ArgumentError\n} = require('../errors');\nconst {\n  JwksClient\n} = require('../JwksClient');\nconst supportedAlg = require('./config');\nmodule.exports.koaJwtSecret = function () {\n  let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  if (!options.jwksUri) {\n    throw new ArgumentError('No JWKS provided. Please provide a jwksUri');\n  }\n  const client = new JwksClient(options);\n  return function secretProvider() {\n    let {\n      alg,\n      kid\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return new Promise((resolve, reject) => {\n      if (!supportedAlg.includes(alg)) {\n        return reject(new Error('Missing / invalid token algorithm'));\n      }\n      client.getSigningKey(kid).then(key => {\n        resolve(key.publicKey || key.rsaPublicKey);\n      }).catch(err => {\n        if (options.handleSigningKeyError) {\n          return options.handleSigningKeyError(err).then(reject);\n        }\n        return reject(err);\n      });\n    });\n  };\n};","map":{"version":3,"names":["ArgumentError","require","JwksClient","supportedAlg","module","exports","koaJwtSecret","options","jwksUri","client","secretProvider","alg","kid","Promise","resolve","reject","includes","Error","getSigningKey","then","key","publicKey","rsaPublicKey","catch","err","handleSigningKeyError"],"sources":["/home/yadu/Music/Gifty/node_modules/jwks-rsa/src/integrations/koa.js"],"sourcesContent":["const { ArgumentError } = require('../errors');\nconst { JwksClient } = require('../JwksClient');\nconst supportedAlg = require('./config');\n\nmodule.exports.koaJwtSecret = function (options = {}) {\n  if (!options.jwksUri) {\n    throw new ArgumentError('No JWKS provided. Please provide a jwksUri');\n  }\n\n  const client = new JwksClient(options);\n\n  return function secretProvider({ alg, kid } = {}) {\n    return new Promise((resolve, reject) => {\n      if (!supportedAlg.includes(alg)) {\n        return reject(new Error('Missing / invalid token algorithm'));\n      }\n\n      client.getSigningKey(kid)\n        .then(key => {\n          resolve(key.publicKey || key.rsaPublicKey);\n        }).catch(err => {\n          if (options.handleSigningKeyError) {\n            return options.handleSigningKeyError(err).then(reject);\n          }\n\n          return reject(err);\n        });\n    });\n  };\n};\n"],"mappings":"AAAA,MAAM;EAAEA;AAAc,CAAC,GAAGC,OAAO,CAAC,WAAW,CAAC;AAC9C,MAAM;EAAEC;AAAW,CAAC,GAAGD,OAAO,CAAC,eAAe,CAAC;AAC/C,MAAME,YAAY,GAAGF,OAAO,CAAC,UAAU,CAAC;AAExCG,MAAM,CAACC,OAAO,CAACC,YAAY,GAAG,YAAwB;EAAA,IAAdC,OAAO,uEAAG,CAAC,CAAC;EAClD,IAAI,CAACA,OAAO,CAACC,OAAO,EAAE;IACpB,MAAM,IAAIR,aAAa,CAAC,4CAA4C,CAAC;EACvE;EAEA,MAAMS,MAAM,GAAG,IAAIP,UAAU,CAACK,OAAO,CAAC;EAEtC,OAAO,SAASG,cAAc,GAAoB;IAAA,IAAnB;MAAEC,GAAG;MAAEC;IAAI,CAAC,uEAAG,CAAC,CAAC;IAC9C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI,CAACZ,YAAY,CAACa,QAAQ,CAACL,GAAG,CAAC,EAAE;QAC/B,OAAOI,MAAM,CAAC,IAAIE,KAAK,CAAC,mCAAmC,CAAC,CAAC;MAC/D;MAEAR,MAAM,CAACS,aAAa,CAACN,GAAG,CAAC,CACtBO,IAAI,CAACC,GAAG,IAAI;QACXN,OAAO,CAACM,GAAG,CAACC,SAAS,IAAID,GAAG,CAACE,YAAY,CAAC;MAC5C,CAAC,CAAC,CAACC,KAAK,CAACC,GAAG,IAAI;QACd,IAAIjB,OAAO,CAACkB,qBAAqB,EAAE;UACjC,OAAOlB,OAAO,CAACkB,qBAAqB,CAACD,GAAG,CAAC,CAACL,IAAI,CAACJ,MAAM,CAAC;QACxD;QAEA,OAAOA,MAAM,CAACS,GAAG,CAAC;MACpB,CAAC,CAAC;IACN,CAAC,CAAC;EACJ,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}